<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tombola Gratis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #EAE2D6 0%, #D8CFC4 100%);
            font-family: 'Poppins', sans-serif;
        }
        
        .logo-text {
            font-family: 'Pacifico', cursive;
            color: #FF6B35;
            font-size: 3.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .number-ball {
            width: 60px;
            height: 60px;
            background: linear-gradient(145deg, #ffffff, #f0f0f0);
            box-shadow: 
                4px 4px 8px rgba(0, 0, 0, 0.15),
                -2px -2px 6px rgba(255, 255, 255, 0.7),
                inset 0 0 0 1px rgba(255, 255, 255, 0.5);
            color: #D4C5B9;
            font-weight: 700;
            font-size: 1.5rem;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            position: relative;
            overflow: hidden;
        }
        
        .number-ball::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .number-ball:hover::before {
            opacity: 1;
        }
        
        .number-ball:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: 
                6px 6px 12px rgba(0, 0, 0, 0.2),
                -3px -3px 8px rgba(255, 255, 255, 0.8);
        }
        
        .number-ball.extracted {
            background: linear-gradient(145deg, #FF8C42, #F7931E);
            color: white;
            font-weight: 800;
            box-shadow: 
                0 8px 20px rgba(247, 147, 30, 0.5),
                inset 0 2px 4px rgba(255, 255, 255, 0.3),
                inset 0 -2px 4px rgba(0, 0, 0, 0.2);
            animation: extractPulse 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        @keyframes extractPulse {
            0% { transform: scale(0.5) rotate(-180deg); opacity: 0; }
            50% { transform: scale(1.2) rotate(10deg); }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }
        
        .number-ball.extracted::before {
            opacity: 0.5;
        }
        
        .btn-extract {
            background: linear-gradient(145deg, #FF8C42, #F7931E);
            box-shadow: 
                0 8px 16px rgba(247, 147, 30, 0.4),
                inset 0 2px 4px rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .btn-extract::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .btn-extract:active::after {
            width: 300px;
            height: 300px;
        }
        
        .btn-extract:hover {
            transform: translateY(-3px);
            box-shadow: 
                0 12px 24px rgba(247, 147, 30, 0.5),
                inset 0 2px 4px rgba(255, 255, 255, 0.4);
        }
        
        .btn-extract:active {
            transform: translateY(-1px);
        }
        
        .invite-box {
            background: linear-gradient(145deg, #F5F0E8, #EBE5DC);
            box-shadow: 
                8px 8px 16px rgba(0, 0, 0, 0.1),
                -4px -4px 12px rgba(255, 255, 255, 0.8);
        }
        
        .control-btn {
            background: white;
            box-shadow: 
                4px 4px 8px rgba(0, 0, 0, 0.1),
                -2px -2px 6px rgba(255, 255, 255, 0.9);
            transition: all 0.3s ease;
        }
        
        .control-btn:hover {
            box-shadow: 
                2px 2px 4px rgba(0, 0, 0, 0.15),
                -1px -1px 3px rgba(255, 255, 255, 1);
            transform: scale(0.95);
        }
        
        .control-btn:active {
            box-shadow: 
                inset 2px 2px 4px rgba(0, 0, 0, 0.2),
                inset -1px -1px 3px rgba(255, 255, 255, 0.7);
        }
        
        .last-number-card {
            background: white;
            box-shadow: 
                0 10px 30px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.9);
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .number-display {
            animation: numberPop 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        @keyframes numberPop {
            0% { transform: scale(0); opacity: 0; }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .gratis-badge {
            border: 4px solid #FF6B35;
            color: #FF6B35;
            background: white;
            box-shadow: 0 4px 12px rgba(255, 107, 53, 0.3);
        }
        
        .tombola-icon {
            filter: drop-shadow(0 2px 4px rgba(255, 107, 53, 0.3));
        }
        
        .stats-counter {
            background: linear-gradient(145deg, #ffffff, #f5f5f5);
            box-shadow: 
                inset 2px 2px 4px rgba(0, 0, 0, 0.1),
                inset -2px -2px 4px rgba(255, 255, 255, 0.9);
        }

        @media (max-width: 768px) {
            .number-ball {
                width: 48px;
                height: 48px;
                font-size: 1.2rem;
            }
            .logo-text {
                font-size: 2.5rem;
            }
        }

        /* Confetti animation */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #FF6B35;
            position: fixed;
            top: -10px;
            animation: confetti-fall 3s linear forwards;
            z-index: 1000;
        }

        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* Dark mode improvements */
        body.dark-mode {
            background: linear-gradient(135deg, #1a1a2e 0%, #0f0f1e 100%);
        }

        body.dark-mode .number-ball {
            background: linear-gradient(145deg, #2d2d44, #1f1f2e);
            color: #8892b0;
            box-shadow: 
                4px 4px 8px rgba(0, 0, 0, 0.5),
                -2px -2px 6px rgba(255, 255, 255, 0.05);
        }

        body.dark-mode .number-ball.extracted {
            background: linear-gradient(145deg, #FF6B35, #FF8C42);
            box-shadow: 
                0 8px 20px rgba(255, 107, 53, 0.6),
                inset 0 2px 4px rgba(255, 255, 255, 0.3);
        }

        body.dark-mode .last-number-card,
        body.dark-mode .bg-white {
            background: linear-gradient(145deg, #252540, #1a1a30);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        body.dark-mode .invite-box {
            background: linear-gradient(145deg, #2d2d44, #1f1f2e);
            box-shadow: 
                8px 8px 16px rgba(0, 0, 0, 0.5),
                -4px -4px 12px rgba(255, 255, 255, 0.03);
        }

        body.dark-mode .stats-counter {
            background: linear-gradient(145deg, #2d2d44, #1f1f2e);
            box-shadow: 
                inset 2px 2px 4px rgba(0, 0, 0, 0.5),
                inset -2px -2px 4px rgba(255, 255, 255, 0.03);
        }

        body.dark-mode .control-btn {
            background: linear-gradient(145deg, #2d2d44, #1f1f2e);
            box-shadow: 
                4px 4px 8px rgba(0, 0, 0, 0.5),
                -2px -2px 6px rgba(255, 255, 255, 0.05);
        }

        body.dark-mode .text-gray-600 {
            color: #a0aec0;
        }

        body.dark-mode .text-gray-500 {
            color: #718096;
        }

        body.dark-mode .text-gray-700 {
            color: #cbd5e0;
        }

        /* Brasiliana dancing effect */
        .dancer {
            position: fixed;
            z-index: 999;
            pointer-events: none;
            width: 120px;
            height: 180px;
        }

        .dancer-body {
            position: relative;
            width: 100%;
            height: 100%;
        }

        .dancer-head {
            width: 40px;
            height: 40px;
            background: radial-gradient(circle at 30% 30%, #E8A57C, #D2691E 60%, #A0522D);
            border-radius: 50%;
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            animation: head-sway 1.6s ease-in-out infinite;
            box-shadow: 
                inset -3px -3px 6px rgba(0, 0, 0, 0.2),
                inset 2px 2px 4px rgba(255, 255, 255, 0.3),
                0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .dancer-head::after {
            content: '';
            position: absolute;
            top: 8px;
            left: 8px;
            width: 12px;
            height: 12px;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.4), transparent);
            border-radius: 50%;
        }

        .dancer-hair {
            width: 50px;
            height: 28px;
            background: linear-gradient(180deg, #0a0a0a 0%, #1a1a1a 50%, #2a2a2a);
            border-radius: 50% 50% 0 0;
            position: absolute;
            top: -6px;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: 
                inset 0 2px 4px rgba(255, 255, 255, 0.1),
                0 2px 6px rgba(0, 0, 0, 0.4);
        }

        .dancer-hair::before {
            content: '';
            position: absolute;
            top: 5px;
            left: 5px;
            width: 40px;
            height: 3px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 50%;
            box-shadow: 
                0 4px 0 rgba(255, 255, 255, 0.03),
                0 8px 0 rgba(255, 255, 255, 0.02);
        }

        .dancer-hair::after {
            content: 'ðŸŒº';
            position: absolute;
            right: -12px;
            top: 2px;
            font-size: 1.3rem;
            animation: flower-spin 2s linear infinite;
            filter: drop-shadow(0 2px 3px rgba(0, 0, 0, 0.3));
        }

        @keyframes flower-spin {
            0%, 100% { transform: rotate(-10deg); }
            50% { transform: rotate(10deg); }
        }

        .dancer-face {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .dancer-eyes {
            position: absolute;
            top: 35%;
            left: 25%;
            width: 8px;
            height: 10px;
            background: white;
            border-radius: 50%;
            box-shadow: 16px 0 0 white;
        }

        .dancer-eyes::before,
        .dancer-eyes::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 4px;
            height: 6px;
            background: radial-gradient(circle, #1a1a1a, #000);
            border-radius: 50%;
        }

        .dancer-eyes::after {
            left: 18px;
        }

        .dancer-nose {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 5px;
            background: linear-gradient(135deg, #A0522D, #8B4513);
            border-radius: 0 0 50% 50%;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        .dancer-smile {
            position: absolute;
            top: 60%;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 10px;
            border: 2.5px solid #8B4513;
            border-top: none;
            border-radius: 0 0 50% 50%;
        }

        .dancer-smile::before {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 3px;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            box-shadow: 5px 0 0 white, 10px 0 0 white;
        }

        .dancer-torso {
            width: 50px;
            height: 60px;
            background: radial-gradient(ellipse at 50% 20%, #E8A57C, #D2691E 40%, #A0522D 90%);
            position: absolute;
            top: 45px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 8px;
            clip-path: polygon(25% 0%, 75% 0%, 95% 100%, 5% 100%);
            animation: torso-twist 1.6s ease-in-out infinite;
            box-shadow: 
                inset -4px 0 8px rgba(0, 0, 0, 0.15),
                inset 4px 0 8px rgba(255, 255, 255, 0.1),
                0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .dancer-torso::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 12px;
            width: 12px;
            height: 15px;
            background: radial-gradient(circle, rgba(210, 105, 30, 0.6), transparent 70%);
            border-radius: 50%;
            box-shadow: 14px 0 0 rgba(210, 105, 30, 0.6);
        }

        .dancer-torso::after {
            content: '';
            position: absolute;
            top: 25px;
            left: 50%;
            transform: translateX(-50%);
            width: 3px;
            height: 25px;
            background: linear-gradient(180deg, rgba(139, 69, 19, 0.3), transparent);
            border-radius: 2px;
        }

        .dancer-waist {
            width: 32px;
            height: 20px;
            background: radial-gradient(ellipse at 50% 0%, #E8A57C, #D2691E 60%, #A0522D);
            position: absolute;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 8px 8px 4px 4px;
            box-shadow: 
                inset 0 2px 4px rgba(255, 255, 255, 0.1),
                inset 0 -2px 6px rgba(0, 0, 0, 0.2),
                0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .dancer-hips {
            width: 46px;
            height: 28px;
            background: radial-gradient(ellipse at 50% 30%, #E8A57C, #D2691E 50%, #A0522D 90%);
            position: absolute;
            top: 118px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 50% 50% 45% 45%;
            animation: hip-sway 1.2s ease-in-out infinite;
            box-shadow: 
                inset -4px 0 6px rgba(0, 0, 0, 0.15),
                inset 4px 0 6px rgba(255, 255, 255, 0.1),
                0 3px 10px rgba(0, 0, 0, 0.2);
        }

        .dancer-hips::before {
            content: '';
            position: absolute;
            top: 8px;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 12px;
            background: linear-gradient(180deg, rgba(139, 69, 19, 0.2), transparent);
            border-radius: 1px;
        }

        .dancer-arm-left,
        .dancer-arm-right {
            width: 13px;
            height: 52px;
            background: linear-gradient(180deg, #E8A57C 0%, #D2691E 50%, #A0522D 100%);
            position: absolute;
            top: 50px;
            border-radius: 7px;
            box-shadow: 
                inset -2px 0 4px rgba(0, 0, 0, 0.2),
                inset 2px 0 4px rgba(255, 255, 255, 0.15),
                2px 2px 6px rgba(0, 0, 0, 0.15);
        }

        .dancer-arm-left::before,
        .dancer-arm-right::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 3px;
            width: 7px;
            height: 15px;
            background: radial-gradient(ellipse, rgba(210, 105, 30, 0.4), transparent);
            border-radius: 50%;
        }

        .dancer-arm-left {
            left: 20px;
            transform-origin: top center;
            animation: arm-left-wave 2s ease-in-out infinite;
        }

        .dancer-arm-right {
            right: 20px;
            transform-origin: top center;
            animation: arm-right-wave 2s ease-in-out infinite 1s;
        }

        .dancer-leg-left,
        .dancer-leg-right {
            width: 16px;
            height: 58px;
            background: linear-gradient(180deg, #E8A57C 0%, #D2691E 30%, #C97B3A 60%, #A0522D 100%);
            position: absolute;
            top: 143px;
            border-radius: 8px 8px 6px 6px;
            box-shadow: 
                inset -3px 0 6px rgba(0, 0, 0, 0.2),
                inset 3px 0 6px rgba(255, 255, 255, 0.1),
                2px 2px 8px rgba(0, 0, 0, 0.2);
        }

        .dancer-leg-left::before,
        .dancer-leg-right::before {
            content: '';
            position: absolute;
            top: 12px;
            left: 4px;
            width: 8px;
            height: 20px;
            background: radial-gradient(ellipse, rgba(210, 105, 30, 0.3), transparent 70%);
            border-radius: 50%;
        }

        .dancer-leg-left::after,
        .dancer-leg-right::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 16px;
            height: 12px;
            background: linear-gradient(180deg, transparent, #8B4513);
            border-radius: 0 0 6px 6px;
        }

        .dancer-leg-left {
            left: 38px;
            transform-origin: top center;
            animation: leg-left-sway 1.4s ease-in-out infinite;
        }

        .dancer-leg-right {
            right: 38px;
            transform-origin: top center;
            animation: leg-right-sway 1.4s ease-in-out infinite 0.7s;
        }

        /* Animazioni suavi */
        @keyframes head-sway {
            0%, 100% { transform: translateX(-50%) rotate(-3deg); }
            50% { transform: translateX(-50%) rotate(3deg); }
        }

        @keyframes torso-twist {
            0%, 100% { transform: translateX(-50%) rotateY(-8deg) rotateZ(-2deg); }
            50% { transform: translateX(-50%) rotateY(8deg) rotateZ(2deg); }
        }

        @keyframes hip-sway {
            0%, 100% { 
                transform: translateX(-50%) rotateZ(-5deg) translateX(-3px); 
            }
            50% { 
                transform: translateX(-50%) rotateZ(5deg) translateX(3px); 
            }
        }

        @keyframes arm-left-wave {
            0%, 100% { 
                transform: rotate(-20deg) translateY(0); 
            }
            50% { 
                transform: rotate(140deg) translateY(-5px); 
            }
        }

        @keyframes arm-right-wave {
            0%, 100% { 
                transform: rotate(20deg) translateY(0); 
            }
            50% { 
                transform: rotate(-140deg) translateY(-5px); 
            }
        }

        @keyframes leg-left-sway {
            0%, 100% { transform: rotate(0deg) translateX(0); }
            25% { transform: rotate(-8deg) translateX(-2px); }
            75% { transform: rotate(5deg) translateX(1px); }
        }

        @keyframes leg-right-sway {
            0%, 100% { transform: rotate(0deg) translateX(0); }
            25% { transform: rotate(8deg) translateX(2px); }
            75% { transform: rotate(-5deg) translateX(-1px); }
        }

        .dancer-move {
            animation: dancer-move 10s linear;
        }

        @keyframes dancer-move {
            0% {
                transform: translateX(-150px) scale(0.8);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            50% {
                transform: translateX(50vw) scale(1.2);
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateX(calc(100vw + 150px)) scale(0.8);
                opacity: 0;
            }
        }

        /* Varianti di velocitÃ  */
        .dancer-speed-1 { animation-duration: 8s; }
        .dancer-speed-2 { animation-duration: 10s; }
        .dancer-speed-3 { animation-duration: 12s; }

        /* Sparkles attorno alla ballerina */
        .dancer-sparkle {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            animation: sparkle-rotate 3s linear infinite;
        }

        .dancer-sparkle::before,
        .dancer-sparkle::after {
            content: 'âœ¨';
            position: absolute;
            font-size: 1rem;
            animation: sparkle-pulse 1.5s ease-in-out infinite;
        }

        .dancer-sparkle::before {
            top: 20%;
            left: -10px;
        }

        .dancer-sparkle::after {
            top: 40%;
            right: -10px;
            animation-delay: 0.75s;
        }

        @keyframes sparkle-rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes sparkle-pulse {
            0%, 100% { opacity: 0.3; transform: scale(0.8); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        /* Bomb effect */
        .bomb {
            position: fixed;
            font-size: 3rem;
            z-index: 999;
            pointer-events: none;
            animation: bomb-fall 2s ease-in;
        }

        @keyframes bomb-fall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }
            70% {
                opacity: 1;
            }
            100% {
                transform: translateY(calc(100vh + 100px)) rotate(720deg);
                opacity: 1;
            }
        }

        .explosion {
            position: fixed;
            font-size: 6rem;
            z-index: 1000;
            pointer-events: none;
            animation: explode 0.6s ease-out;
        }

        @keyframes explode {
            0% {
                transform: scale(0) rotate(0deg);
                opacity: 1;
            }
            50% {
                transform: scale(1.5) rotate(180deg);
                opacity: 1;
            }
            100% {
                transform: scale(0.5) rotate(360deg);
                opacity: 0;
            }
        }

        .shake {
            animation: shake 0.5s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
            20%, 40%, 60%, 80% { transform: translateX(10px); }
        }

        .mega-shake {
            animation: mega-shake 1.5s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;
        }

        @keyframes mega-shake {
            0%, 100% { 
                transform: translate(0, 0) rotate(0deg);
            }
            10% { 
                transform: translate(-15px, -10px) rotate(-2deg);
            }
            20% { 
                transform: translate(18px, 8px) rotate(2deg);
            }
            30% { 
                transform: translate(-18px, 10px) rotate(-3deg);
            }
            40% { 
                transform: translate(20px, -12px) rotate(2deg);
            }
            50% { 
                transform: translate(-16px, 14px) rotate(-2deg);
            }
            60% { 
                transform: translate(14px, -8px) rotate(3deg);
            }
            70% { 
                transform: translate(-12px, 6px) rotate(-1deg);
            }
            80% { 
                transform: translate(8px, -4px) rotate(1deg);
            }
            90% { 
                transform: translate(-4px, 2px) rotate(-0.5deg);
            }
        }

        .shockwave {
            position: fixed;
            border: 4px solid rgba(255, 140, 0, 0.8);
            border-radius: 50%;
            z-index: 998;
            pointer-events: none;
            animation: shockwave-expand 1s ease-out;
        }

        @keyframes shockwave-expand {
            0% {
                width: 0;
                height: 0;
                opacity: 1;
                border-width: 8px;
            }
            50% {
                opacity: 0.6;
                border-width: 4px;
            }
            100% {
                width: 800px;
                height: 800px;
                opacity: 0;
                border-width: 1px;
            }
        }

        .screen-flash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: radial-gradient(circle, rgba(255, 140, 0, 0.8) 0%, rgba(255, 69, 0, 0.4) 50%, transparent 100%);
            z-index: 997;
            pointer-events: none;
            animation: flash 0.8s ease-out;
        }

        @keyframes flash {
            0% {
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            100% {
                opacity: 0;
            }
        }

        .debris {
            position: fixed;
            font-size: 2rem;
            z-index: 999;
            pointer-events: none;
        }

        .crater-mark {
            position: fixed;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, rgba(0, 0, 0, 0.4) 0%, rgba(0, 0, 0, 0.2) 50%, transparent 100%);
            border-radius: 50%;
            z-index: 1;
            pointer-events: none;
            animation: crater-fade 3s ease-out forwards;
        }

        @keyframes crater-fade {
            0% {
                opacity: 1;
                transform: scale(0);
            }
            10% {
                transform: scale(1.2);
            }
            20% {
                transform: scale(1);
            }
            100% {
                opacity: 0;
                transform: scale(1);
            }
        }
    </style>
</head>
<body class="p-4 md:p-8 min-h-screen">
    <div class="max-w-7xl mx-auto">
        <div class="flex flex-col lg:flex-row gap-8">
            <div class="flex-1">
                <div class="mb-6 flex gap-4 flex-wrap">
                    <div class="stats-counter px-6 py-3 rounded-2xl flex items-center gap-3">
                        <span class="text-gray-600 font-semibold">Estratti:</span>
                        <span id="extractedCount" class="text-2xl font-bold text-orange-500">0</span>
                        <span class="text-gray-400">/90</span>
                    </div>
                    <div class="stats-counter px-6 py-3 rounded-2xl flex items-center gap-3">
                        <span class="text-gray-600 font-semibold">Rimanenti:</span>
                        <span id="remainingCount" class="text-2xl font-bold text-blue-500">90</span>
                    </div>
                    <button onclick="resetGame()" class="px-6 py-3 bg-red-500 text-white rounded-2xl font-semibold hover:bg-red-600 transition shadow-lg">
                        Reset
                    </button>
                </div>

                <!-- Grid numeri -->
                <div class="grid grid-cols-10 gap-3 md:gap-4" id="board">
                    <!-- Generato con JS -->
                </div>

                <!-- History -->
                <div class="mt-6 p-6 bg-white rounded-3xl shadow-lg">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Ultimi numeri estratti</h3>
                    <div id="history" class="flex flex-wrap gap-2">
                        <span class="text-gray-400 italic">Nessun numero estratto ancora</span>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="lg:w-96 flex flex-col gap-6">
                <!-- Logo -->
                <div class="text-center bg-white rounded-3xl p-6 shadow-lg">
                    <div class="flex justify-center items-center mb-3">
                        <svg class="w-16 h-16 tombola-icon" viewBox="0 0 100 100" fill="#FF6B35">
                            <circle cx="50" cy="30" r="22"/>
                            <ellipse cx="50" cy="70" rx="28" ry="18"/>
                            <circle cx="42" cy="26" r="5" fill="white" opacity="0.7"/>
                        </svg>
                    </div>
                    <div class="logo-text mb-3">Tombola</div>
                    <div class="inline-block gratis-badge px-6 py-2 rounded-xl font-bold text-xl">
                        GRATIS
                    </div>
                </div>

                <!-- Numero estratto grande -->
                <div id="lastNumber" class="last-number-card p-8 rounded-3xl text-center hidden">
                    <p class="text-gray-500 text-sm font-semibold mb-3 uppercase tracking-wider">Ultimo numero estratto</p>
                    <div class="relative">
                        <div class="number-display text-8xl font-black text-orange-500" id="currentNumber">-</div>
                        <div class="absolute -top-2 -right-2 w-6 h-6 bg-red-500 rounded-full animate-ping"></div>
                    </div>
                </div>

                <!-- Pulsante Estrai -->
                <button onclick="extractNumber()" class="btn-extract text-white font-bold py-5 px-8 rounded-full text-2xl shadow-lg w-full relative z-10">
                    Estrai numero
                </button>

                <!-- Auto-extract -->
                <div class="bg-white rounded-3xl p-6 shadow-lg">
                    <div class="flex items-center justify-between mb-4">
                        <span class="font-semibold text-gray-700">Estrazione automatica</span>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="autoExtract" class="sr-only peer" onchange="toggleAutoExtract()">
                            <div class="w-14 h-7 bg-gray-300 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-orange-500"></div>
                        </label>
                    </div>
                    <div id="autoExtractControls" class="hidden">
                        <label class="text-sm text-gray-600 mb-2 block">Intervallo (secondi):</label>
                        <input type="range" id="intervalSlider" min="1" max="10" value="3" class="w-full" oninput="updateInterval(this.value)">
                        <div class="text-center text-orange-500 font-bold mt-2">
                            <span id="intervalDisplay">3</span>s
                        </div>
                    </div>
                </div>

                <!-- Box Invito -->
                <div class="invite-box p-6 text-center rounded-3xl">
                    <p class="text-gray-600 text-sm mb-2">
                        Invita i tuoi amici a creare una nuova cartella su
                    </p>
                    <p class="text-orange-600 font-bold text-lg mb-2">TombolaGratis.it</p>
                    <p class="text-gray-500 text-xs leading-relaxed">
                        da PC, smartphone...<br>
                        Estrai e buon divertimento!
                    </p>
                </div>

                <!-- Effetti speciali -->
                <div class="bg-white rounded-3xl p-6 shadow-lg">
                    <h3 class="text-lg font-bold text-gray-700 mb-4 text-center">ðŸŽ­ Effetti Speciali</h3>
                    <div class="grid grid-cols-3 gap-3">
                        <button onclick="spawnDancers()" class="control-btn px-4 py-3 rounded-2xl font-semibold text-gray-700 hover:text-orange-500 transition flex flex-col items-center justify-center gap-1">
                            <span class="text-2xl">ðŸ’ƒ</span>
                            <span class="text-xs">Brasiliane</span>
                        </button>
                        <button onclick="dropBomb()" class="control-btn px-4 py-3 rounded-2xl font-semibold text-gray-700 hover:text-red-500 transition flex flex-col items-center justify-center gap-1">
                            <span class="text-2xl">ðŸ’£</span>
                            <span class="text-xs">Bomba!</span>
                        </button>
                        <button onclick="partyMode()" class="control-btn px-4 py-3 rounded-2xl font-semibold text-gray-700 hover:text-purple-500 transition flex flex-col items-center justify-center gap-1">
                            <span class="text-2xl">ðŸŽ‰</span>
                            <span class="text-xs">Party</span>
                        </button>
                    </div>
                </div>

                <!-- Controlli -->
                <div class="flex justify-around items-center bg-white rounded-full p-4 shadow-xl">
                    <button onclick="toggleTheme()" class="control-btn p-3 rounded-full transition" title="Cambia tema">
                        <svg id="themeIcon" class="w-7 h-7 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>
                        </svg>
                    </button>
                    <button onclick="toggleSound()" class="control-btn p-3 rounded-full transition" title="Attiva/Disattiva suono">
                        <svg id="soundIcon" class="w-7 h-7 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"/>
                        </svg>
                    </button>
                    <button onclick="showInfo()" class="control-btn p-3 rounded-full transition" title="Informazioni">
                        <svg class="w-7 h-7 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Stato del gioco
        const gameState = {
            extracted: new Set(),
            soundEnabled: true,
            currentNumber: null,
            history: [],
            darkMode: false,
            autoExtract: false,
            autoExtractInterval: null,
            intervalSeconds: 3
        };

        // Genera il tabellone
        function initBoard() {
            const board = document.getElementById('board');
            board.innerHTML = '';
            for (let i = 1; i <= 90; i++) {
                const ball = document.createElement('div');
                ball.className = 'number-ball flex items-center justify-center rounded-full cursor-pointer';
                ball.textContent = i;
                ball.id = `ball-${i}`;
                ball.onclick = () => toggleNumber(i);
                board.appendChild(ball);
            }
        }

        // Estrai numero casuale
        function extractNumber() {
            if (gameState.extracted.size === 90) {
                createConfetti();
                alert('ðŸŽ‰ Complimenti! Tutti i numeri sono stati estratti!\n\nPremi Reset per iniziare una nuova partita.');
                return;
            }

            let number;
            do {
                number = Math.floor(Math.random() * 90) + 1;
            } while (gameState.extracted.has(number));

            gameState.extracted.add(number);
            gameState.currentNumber = number;
            gameState.history.unshift(number);

            // Mantieni solo gli ultimi 10
            if (gameState.history.length > 10) {
                gameState.history.pop();
            }

            // Aggiorna UI
            const ball = document.getElementById(`ball-${number}`);
            ball.classList.add('extracted');

            // Mostra numero estratto
            const lastNumberDiv = document.getElementById('lastNumber');
            const currentNumberSpan = document.getElementById('currentNumber');
            lastNumberDiv.classList.remove('hidden');
            currentNumberSpan.textContent = number;
            currentNumberSpan.classList.remove('number-display');
            void currentNumberSpan.offsetWidth; // Force reflow
            currentNumberSpan.classList.add('number-display');

            // Aggiorna stats
            updateStats();
            updateHistory();

            // Suono
            if (gameState.soundEnabled) {
                playSound(number);
            }

            // Annuncio vocale
            speakNumber(number);
        }

        // Toggle manuale numero
        function toggleNumber(number) {
            const ball = document.getElementById(`ball-${number}`);
            if (gameState.extracted.has(number)) {
                gameState.extracted.delete(number);
                ball.classList.remove('extracted');
                gameState.history = gameState.history.filter(n => n !== number);
            } else {
                gameState.extracted.add(number);
                ball.classList.add('extracted');
                gameState.history.unshift(number);
            }
            updateStats();
            updateHistory();
        }

        // Reset gioco
        function resetGame() {
            if (gameState.extracted.size === 0) return;
            
            if (confirm('Sei sicuro di voler resettare la partita?')) {
                gameState.extracted.clear();
                gameState.history = [];
                gameState.currentNumber = null;
                
                // Reset UI
                for (let i = 1; i <= 90; i++) {
                    const ball = document.getElementById(`ball-${i}`);
                    ball.classList.remove('extracted');
                }
                
                document.getElementById('lastNumber').classList.add('hidden');
                updateStats();
                updateHistory();
                
                if (gameState.autoExtract) {
                    toggleAutoExtract();
                }
            }
        }

        // Aggiorna statistiche
        function updateStats() {
            document.getElementById('extractedCount').textContent = gameState.extracted.size;
            document.getElementById('remainingCount').textContent = 90 - gameState.extracted.size;
        }

        // Aggiorna cronologia
        function updateHistory() {
            const historyDiv = document.getElementById('history');
            if (gameState.history.length === 0) {
                historyDiv.innerHTML = '<span class="text-gray-400 italic">Nessun numero estratto ancora</span>';
            } else {
                historyDiv.innerHTML = gameState.history.map(num => 
                    `<span class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-gradient-to-br from-orange-400 to-orange-600 text-white font-bold text-lg shadow-md">${num}</span>`
                ).join('');
            }
        }

        // Auto extract
        function toggleAutoExtract() {
            const checkbox = document.getElementById('autoExtract');
            const controls = document.getElementById('autoExtractControls');
            gameState.autoExtract = checkbox.checked;
            
            if (gameState.autoExtract) {
                controls.classList.remove('hidden');
                gameState.autoExtractInterval = setInterval(() => {
                    if (gameState.extracted.size < 90) {
                        extractNumber();
                    } else {
                        toggleAutoExtract();
                        checkbox.checked = false;
                    }
                }, gameState.intervalSeconds * 1000);
            } else {
                controls.classList.add('hidden');
                if (gameState.autoExtractInterval) {
                    clearInterval(gameState.autoExtractInterval);
                    gameState.autoExtractInterval = null;
                }
            }
        }

        function updateInterval(value) {
            gameState.intervalSeconds = parseInt(value);
            document.getElementById('intervalDisplay').textContent = value;
            
            if (gameState.autoExtract) {
                clearInterval(gameState.autoExtractInterval);
                gameState.autoExtractInterval = setInterval(() => {
                    if (gameState.extracted.size < 90) {
                        extractNumber();
                    }
                }, gameState.intervalSeconds * 1000);
            }
        }

        // Toggle suono
        function toggleSound() {
            gameState.soundEnabled = !gameState.soundEnabled;
            const icon = document.getElementById('soundIcon');
            if (!gameState.soundEnabled) {
                icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"/>';
            } else {
                icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"/>';
            }
        }

        // Suono migliorato
        function playSound(number) {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                // Nota principale
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 600 + (number * 5);
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            } catch (e) {
                console.log('Audio not supported');
            }
        }

        // Annuncio vocale
        function speakNumber(number) {
            if (gameState.soundEnabled && 'speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(number.toString());
                utterance.lang = 'it-IT';
                utterance.rate = 0.9;
                utterance.pitch = 1.1;
                speechSynthesis.speak(utterance);
            }
        }

        // Toggle tema
        function toggleTheme() {
            gameState.darkMode = !gameState.darkMode;
            const icon = document.getElementById('themeIcon');
            
            if (gameState.darkMode) {
                document.body.classList.add('dark-mode');
                icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/>';
            } else {
                document.body.classList.remove('dark-mode');
                icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>';
            }
        }

        // Confetti
        function createConfetti() {
            const colors = ['#FF6B35', '#F7931E', '#FFD700', '#FF1493', '#00CED1'];
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDelay = Math.random() * 2 + 's';
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 3000);
                }, i * 30);
            }
        }

        // Info
        function showInfo() {
            alert('ðŸŽ² Tombola Gratis - Guida\n\n' +
                  'âœ¨ FUNZIONALITÃ€:\n' +
                  'â€¢ Clicca "Estrai numero" per estrarre\n' +
                  'â€¢ Clicca sui numeri per segnarli manualmente\n' +
                  'â€¢ Attiva estrazione automatica per giocare da solo\n' +
                  'â€¢ Regola velocitÃ  di estrazione automatica\n' +
                  'â€¢ Cronologia ultimi 10 numeri estratti\n' +
                  'â€¢ Annuncio vocale dei numeri\n' +
                  'â€¢ Tema chiaro/scuro\n' +
                  'â€¢ Effetti sonori\n\n' +
                  'ðŸŽ¯ Buon divertimento!');
        }

        // Effetti speciali
        function spawnDancers() {
            const count = 3 + Math.floor(Math.random() * 2);
            const colors = [
                ['#FF1493', '#FF69B4'],  // Rosa
                ['#FFD700', '#FFA500'],  // Oro
                ['#00CED1', '#1E90FF'],  // Azzurro
                ['#FF6347', '#FF4500'],  // Rosso
                ['#9370DB', '#BA55D3']   // Viola
            ];
            
            for (let i = 0; i < count; i++) {
                setTimeout(() => {
                    const dancer = document.createElement('div');
                    dancer.className = `dancer dancer-move dancer-speed-${(i % 3) + 1}`;
                    dancer.style.top = (Math.random() * 60 + 10) + '%';
                    dancer.style.left = '-150px';
                    
                    // Scegli colori casuali
                    const colorPair = colors[Math.floor(Math.random() * colors.length)];
                    
                    dancer.innerHTML = `
                        <div class="dancer-body">
                            <div class="dancer-sparkle"></div>
                            
                            <!-- Testa -->
                            <div class="dancer-head">
                                <div class="dancer-hair"></div>
                                <div class="dancer-face">
                                    <div class="dancer-eyes"></div>
                                    <div class="dancer-nose"></div>
                                    <div class="dancer-smile"></div>
                                </div>
                            </div>
                            
                            <!-- Braccia -->
                            <div class="dancer-arm-left"></div>
                            <div class="dancer-arm-right"></div>
                            
                            <!-- Torso -->
                            <div class="dancer-torso"></div>
                            
                            <!-- Vita -->
                            <div class="dancer-waist"></div>
                            
                            <!-- Fianchi -->
                            <div class="dancer-hips"></div>
                            
                            <!-- Gambe -->
                            <div class="dancer-leg-left"></div>
                            <div class="dancer-leg-right"></div>
                        </div>
                    `;
                    
                    document.body.appendChild(dancer);
                    
                    // Musica brasiliana (suono sintetizzato)
                    if (gameState.soundEnabled) {
                        playSambaSound();
                    }
                    
                    // Rimuovi dopo l'animazione
                    const duration = [8000, 10000, 12000][i % 3];
                    setTimeout(() => dancer.remove(), duration);
                }, i * 1200);
            }
        }

        function playSambaSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const now = audioContext.currentTime;
                
                // Ritmo di samba
                [0, 0.15, 0.3, 0.5].forEach((time, i) => {
                    const osc = audioContext.createOscillator();
                    const gain = audioContext.createGain();
                    
                    osc.connect(gain);
                    gain.connect(audioContext.destination);
                    
                    osc.frequency.value = [400, 500, 450, 550][i];
                    osc.type = 'triangle';
                    
                    gain.gain.setValueAtTime(0.1, now + time);
                    gain.gain.exponentialRampToValueAtTime(0.01, now + time + 0.1);
                    
                    osc.start(now + time);
                    osc.stop(now + time + 0.1);
                });
            } catch (e) {
                console.log('Audio not supported');
            }
        }

        function dropBomb() {
            const bomb = document.createElement('div');
            bomb.className = 'bomb';
            bomb.textContent = 'ðŸ’£';
            bomb.style.left = Math.random() * (window.innerWidth - 100) + 'px';
            bomb.style.top = '-100px';
            document.body.appendChild(bomb);
            
            // Suono fischio bomba
            if (gameState.soundEnabled) {
                playBombSound();
            }
            
            setTimeout(() => {
                const rect = bomb.getBoundingClientRect();
                const explosionX = rect.left + rect.width / 2;
                const explosionY = rect.top + rect.height / 2;
                bomb.remove();
                
                // MEGA ESPLOSIONE
                createMegaExplosion(explosionX, explosionY);
                
                // MEGA SHAKE dello schermo
                document.body.classList.add('mega-shake');
                setTimeout(() => document.body.classList.remove('mega-shake'), 1500);
                
                // Flash dello schermo
                createScreenFlash();
                
                // Onde d'urto multiple
                createShockwaves(explosionX, explosionY);
                
                // Cratere
                createCrater(explosionX, explosionY);
                
                // Detriti volanti
                createDebris(explosionX, explosionY);
                
                // Suono esplosione potenziato
                if (gameState.soundEnabled) {
                    playMegaExplosionSound();
                }
            }, 2000);
        }

        function createMegaExplosion(x, y) {
            // Esplosione principale piÃ¹ grande
            const explosion = document.createElement('div');
            explosion.className = 'explosion';
            explosion.textContent = 'ðŸ’¥';
            explosion.style.left = x + 'px';
            explosion.style.top = y + 'px';
            explosion.style.fontSize = '10rem';
            document.body.appendChild(explosion);
            
            // Particle effects potenziati
            const particles = ['ðŸ”¥', 'â­', 'âœ¨', 'ðŸ’«', 'ðŸ’¥', 'ðŸŒŸ'];
            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.textContent = particles[Math.floor(Math.random() * particles.length)];
                particle.style.position = 'fixed';
                particle.style.left = x + 'px';
                particle.style.top = y + 'px';
                particle.style.fontSize = (2 + Math.random() * 2) + 'rem';
                particle.style.zIndex = '1000';
                particle.style.pointerEvents = 'none';
                
                const angle = (i / 30) * Math.PI * 2;
                const distance = 150 + Math.random() * 200;
                const endX = x + Math.cos(angle) * distance;
                const endY = y + Math.sin(angle) * distance;
                const rotation = Math.random() * 720 - 360;
                
                particle.animate([
                    { transform: 'translate(0, 0) scale(1) rotate(0deg)', opacity: 1 },
                    { transform: `translate(${endX - x}px, ${endY - y}px) scale(0) rotate(${rotation}deg)`, opacity: 0 }
                ], {
                    duration: 1000 + Math.random() * 600,
                    easing: 'ease-out'
                });
                
                document.body.appendChild(particle);
                setTimeout(() => particle.remove(), 1600);
            }
            
            setTimeout(() => explosion.remove(), 600);
        }

        function playBombSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const osc = audioContext.createOscillator();
                const gain = audioContext.createGain();
                
                osc.connect(gain);
                gain.connect(audioContext.destination);
                
                osc.frequency.setValueAtTime(800, audioContext.currentTime);
                osc.frequency.exponentialRampToValueAtTime(200, audioContext.currentTime + 1.5);
                osc.type = 'sine';
                
                gain.gain.setValueAtTime(0.2, audioContext.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.5);
                
                osc.start();
                osc.stop(audioContext.currentTime + 1.5);
            } catch (e) {
                console.log('Audio not supported');
            }
        }

        function createScreenFlash() {
            const flash = document.createElement('div');
            flash.className = 'screen-flash';
            document.body.appendChild(flash);
            setTimeout(() => flash.remove(), 800);
        }

        function createShockwaves(x, y) {
            // 3 onde d'urto concentriche
            for (let i = 0; i < 3; i++) {
                setTimeout(() => {
                    const shockwave = document.createElement('div');
                    shockwave.className = 'shockwave';
                    shockwave.style.left = (x - 0) + 'px';
                    shockwave.style.top = (y - 0) + 'px';
                    shockwave.style.borderColor = `rgba(255, ${140 - i * 30}, 0, ${0.8 - i * 0.2})`;
                    document.body.appendChild(shockwave);
                    setTimeout(() => shockwave.remove(), 1000);
                }, i * 150);
            }
        }

        function createCrater(x, y) {
            const crater = document.createElement('div');
            crater.className = 'crater-mark';
            crater.style.left = (x - 50) + 'px';
            crater.style.top = (y - 50) + 'px';
            document.body.appendChild(crater);
            setTimeout(() => crater.remove(), 3000);
        }

        function createDebris(x, y) {
            const debrisItems = ['ðŸª¨', 'ðŸ’¨', 'ðŸŒ«ï¸', 'â˜„ï¸', 'ðŸ”¶', 'ðŸ”¸'];
            for (let i = 0; i < 20; i++) {
                const debris = document.createElement('div');
                debris.className = 'debris';
                debris.textContent = debrisItems[Math.floor(Math.random() * debrisItems.length)];
                debris.style.left = x + 'px';
                debris.style.top = y + 'px';
                
                const angle = Math.random() * Math.PI * 2;
                const distance = 200 + Math.random() * 300;
                const endX = x + Math.cos(angle) * distance;
                const endY = y + Math.sin(angle) * distance + Math.random() * 100;
                
                debris.animate([
                    { 
                        transform: 'translate(0, 0) rotate(0deg)', 
                        opacity: 1 
                    },
                    { 
                        transform: `translate(${endX - x}px, ${endY - y}px) rotate(${Math.random() * 1080}deg)`, 
                        opacity: 0 
                    }
                ], {
                    duration: 1500 + Math.random() * 1000,
                    easing: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)'
                });
                
                document.body.appendChild(debris);
                setTimeout(() => debris.remove(), 2500);
            }
        }

        function playExplosionSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const noise = audioContext.createBufferSource();
                const buffer = audioContext.createBuffer(1, audioContext.sampleRate * 0.5, audioContext.sampleRate);
                const data = buffer.getChannelData(0);
                
                for (let i = 0; i < buffer.length; i++) {
                    data[i] = Math.random() * 2 - 1;
                }
                
                noise.buffer = buffer;
                const gain = audioContext.createGain();
                const filter = audioContext.createBiquadFilter();
                
                noise.connect(filter);
                filter.connect(gain);
                gain.connect(audioContext.destination);
                
                filter.type = 'lowpass';
                filter.frequency.setValueAtTime(1000, audioContext.currentTime);
                filter.frequency.exponentialRampToValueAtTime(50, audioContext.currentTime + 0.5);
                
                gain.gain.setValueAtTime(0.3, audioContext.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                noise.start();
                noise.stop(audioContext.currentTime + 0.5);
            } catch (e) {
                console.log('Audio not supported');
            }
        }

        function playMegaExplosionSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                // Boom principale piÃ¹ profondo
                const noise = audioContext.createBufferSource();
                const buffer = audioContext.createBuffer(1, audioContext.sampleRate * 1.2, audioContext.sampleRate);
                const data = buffer.getChannelData(0);
                
                for (let i = 0; i < buffer.length; i++) {
                    data[i] = Math.random() * 2 - 1;
                }
                
                noise.buffer = buffer;
                const gain = audioContext.createGain();
                const filter = audioContext.createBiquadFilter();
                
                noise.connect(filter);
                filter.connect(gain);
                gain.connect(audioContext.destination);
                
                filter.type = 'lowpass';
                filter.frequency.setValueAtTime(2000, audioContext.currentTime);
                filter.frequency.exponentialRampToValueAtTime(30, audioContext.currentTime + 1.2);
                
                gain.gain.setValueAtTime(0.5, audioContext.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.2);
                
                noise.start();
                noise.stop(audioContext.currentTime + 1.2);
                
                // Sub-bass per l'impatto
                const bass = audioContext.createOscillator();
                const bassGain = audioContext.createGain();
                
                bass.connect(bassGain);
                bassGain.connect(audioContext.destination);
                
                bass.type = 'sine';
                bass.frequency.setValueAtTime(60, audioContext.currentTime);
                bass.frequency.exponentialRampToValueAtTime(20, audioContext.currentTime + 0.8);
                
                bassGain.gain.setValueAtTime(0.6, audioContext.currentTime);
                bassGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.8);
                
                bass.start();
                bass.stop(audioContext.currentTime + 0.8);
            } catch (e) {
                console.log('Audio not supported');
            }
        }

        function partyMode() {
            // Combo di effetti!
            spawnDancers();
            setTimeout(() => createConfetti(), 500);
            setTimeout(() => spawnDancers(), 2000);
            setTimeout(() => createConfetti(), 3000);
            
            // Cambio colori random del body
            const originalBg = document.body.style.background;
            const colors = [
                'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
                'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',
                'linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)'
            ];
            
            let colorIndex = 0;
            const colorInterval = setInterval(() => {
                if (!gameState.darkMode) {
                    document.body.style.background = colors[colorIndex % colors.length];
                    colorIndex++;
                }
            }, 500);
            
            setTimeout(() => {
                clearInterval(colorInterval);
                if (!gameState.darkMode) {
                    document.body.style.background = 'linear-gradient(135deg, #EAE2D6 0%, #D8CFC4 100%)';
                }
            }, 5000);
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                extractNumber();
            } else if (e.code === 'KeyR' && e.ctrlKey) {
                e.preventDefault();
                resetGame();
            } else if (e.code === 'KeyD') {
                spawnDancers();
            } else if (e.code === 'KeyB') {
                dropBomb();
            } else if (e.code === 'KeyP') {
                partyMode();
            }
        });

        // Inizializza
        initBoard();
        updateStats();
    </script>
</body>
</html>